<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>SPARQLgraph</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- For third-generation iPad with high-resolution Retina display: -->

  <!-- For iPhone with high-resolution Retina display: -->

  <!-- For first- and second-generation iPad: -->

  <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->

  <link href="../../iidx-oss/css/iids.css" rel="stylesheet" type="text/css">
  <link href="../../iidx-oss/css/responsive.css" rel="stylesheet" type="text/css">
  
  <!--[if lt IE 9]>
    <link id="theme-ie" href="../../iidx-oss/css/ie.css" rel="stylesheet" type="text/css">
  <![endif]-->

  	<script src="../../iidx-oss/components/modernizr/modernizr.js"></script>
  
    <!-- Include the required JavaScript libraries: -->
    <script type="text/javascript" src="../jquery/jquery.js"></script>
    <script type="text/javascript" src="../jquery/jquery-ui-1.10.4.min.js"></script>
    
	<script type="text/javascript" src='../jquery/jquery.cookie.js'></script>	
	<script type="text/javascript" src='../jquery/jquery.jsonp-2.3.0.min.js'></script>
	
	<!-- includes for graph -->
    <script type="text/javascript" src="../js/raphael-min.js"></script>
    <script type="text/javascript" src="../js/dracula_graffle.js"></script>
    <script type="text/javascript" src="../js/dracula_graph.js"></script>
    <script type="text/javascript" src="../js/belmont.js"></script>
    <script type="text/javascript" src="../js/graphGlue.js"></script>

    
    <link rel='stylesheet' type='text/css' href='../dynatree-1.2.5/skin/ui.dynatree.css'>
    <script src='../dynatree-1.2.5/jquery.dynatree.js' type="text/javascript"></script>
		
	<!-- CSS stuff -->
	<!--  PEC TODO use the iids modal dialog -->
	<link rel="stylesheet" type="text/css" href="../css/modaldialog.css" />
	
	<!-- Include local javascript -->
	<script type="text/javascript" src="./sparqlgraphconfigOss.js"></script>
	
	<!-- LOGGING  -->
	<script type="text/javascript" src="KDLEasyLoggerConfigOss.js"></script>
	
	 <!-- long-term trouble with require.js unless I do this -->
	<script src="../../iidx-oss/components/bootstrap/js/bootstrap-modal.js"></script>
	<script src="../../iidx-oss/components/bootstrap/js/bootstrap-tooltip.js"></script>
	<script src="../../iidx-oss/components/bootstrap/js/bootstrap-transition.js"></script>
	
	<!-- These should be removed -->
	<script type="text/javascript" src="../js/sparqlserverinterface.js"></script>
	<script type="text/javascript" src='../js/ontologytree.js'></script>
	<script type="text/javascript" src='../js/ontologyinfo.js'></script>	
	<script type="text/javascript" src='../js/queryserverinterface.js'></script>	
	<script type="text/javascript" src="../js/cookiemanager.js"></script>
	<script type="text/javascript" src="../js/sparqlconnection.js"></script>
	<script type="text/javascript" src="../js/modalloaddialog.js"></script>	
	<script type="text/javascript" src="../js/modalconstraintdialog.js"></script>	
	<script type="text/javascript" src="../js/modaldialog.js"></script>		

	<!--  require.js -->
	<script src="../../iidx-oss/components/requirejs/require.js"></script>
	<script src="../../iidx-oss/js/require.config.js"></script>
	
	<script src="../js/sparqlgraph.js"></script>
	
	<script type="text/javascript">

		require.config({
			baseUrl : '../../iidx-oss',
	  		paths: {
	    		"jsonp": "../sparqlGraph/jquery/jquery.jsonp-2.3.0.min",
	    		"sparqlgraph": "../sparqlGraph",
	    		"jquery-csv" : "../sparqlGraph/jquery/jquery.csv-0.71.min",
	    		"local" :      "../sparqlGraph/main-oss"
	      	},
	  		
	  		shim : {
	  		}
		});
	    
		requirejs.onError = function (err) {
		    if (err.requireType === 'timeout') {
		        alert("Require.js page loading time-out. (Try reloading the page)  \nError: "+err);
		    } 
		    else {
		    	console.log(err.stack);
		        throw err;
		    }   
		};
	</script>
	
	<script src="../js/sparqlgraph.js"></script>
	<script src="./sparqlgraphlocal.js"></script>
	
	<!-- TODO Use iids table -->
	<style type="text/css">
		.tg  {border-collapse:collapse;border-spacing:0;border-color:#999;}
		.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#999;color:#444;background-color:#DFF4FF;border-top-width:1px;border-bottom-width:1px;}
		.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:bold;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#999;color:#000000;background-color:#9CDEFF;border-top-width:1px;border-bottom-width:1px;}
		.tg .tg-e3zv{font-weight:bold}
		.tgembed {width:100%;}
	</style>
	
	<script type="text/javascript">
		//
		// Global error handling designed specifically for SSO logouts - which cause tricky side-effects
		//
		// http://stackoverflow.com/questions/951791/javascript-global-error-handling
		window.onerror = function(msg, url, line, col, error) {
		   // Note that col & error are new to the HTML 5 spec and may not be supported
		   var extra;
		   extra += !col ?   '' : '\ncolumn: ' + col;
		   extra += !error ? '' : '\nerror: '  + error;
		
		   alert("Error: " + msg + "\nurl: " + url + "\nline: " + line + "\n" + extra);
		   console.log(error.stack);
		   return false;
		};
	</script>
	
	<script>
		// =========== custom for OSS version =========
		doAbout = function() {
			logAndAlert(g.help.buildHtml + '<br>' + g.help.aboutHtml + '<br>' + g.help.legalNoticeHtml, 'About SPARQLgraph');
		}
		
		doHelp = function () {
			var url = g.help.url.base + "#" + g.help.url[gCurrentTab];
			window.open(url);
		}
		
		doHelpBlog = function () {
			var url = g.help.url.blog;
			window.open(url);
		}
		
		doHelpSparqlGraph = function () {
			var url = g.help.url.base;
			window.open(url);
		}
	</script>
		
	<!-- Right justification for spans -->
    <style type="text/css">
		.right
		{
			float: right;
			text-align: center;
		}
	</style>
	<!--  these would make the tabs look like tabs 
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<link rel="stylesheet" href="/resources/demos/style.css">
	-->
</head>
<body>

	<!---------------  Top Nav Bar --------------->
	<div class="navbar navbar-static-top">
		<!--  Header -->
		<div class="navbar-inner">
		<br>
			<div class="container">
				<a class="brand" href="#"></span> <span>SPARQLgraph <small><i>powered by</i> GE Research Knowledge Discovery Lab</small></span></a>  
			</div>
		</div>
		
		<!---------------  Menu --------------->
		<div class="primary-navbar nav-collapse">
			<div class="container">
		      <ul class="nav">
					<li class="dropdown"><a href="#" data-toggle="dropdown">File<i class="icon-chevron-down"></i></a>
						<ul class="dropdown-menu pull-right">
							<li><a href="javascript:doLoad();">Load</a></li>
							<li><a href="javascript:doUnload();">Unload</a></li>
						</ul>				
					</li>
					
					<li class="dropdown"><a href="#" data-toggle="dropdown">Nodegroup<i class="icon-chevron-down"></i></a>
						<ul class="dropdown-menu pull-right">
							<li><a href="javascript:doNodeGroupUpload();">Upload...</a></li>
							<li><a href="javascript:doNodeGroupDownload();">Download...</a></li>							
						</ul>				
					</li>
					 
					<li class="dropdown"><a href="#" data-toggle="dropdown">Help<i class="icon-chevron-down"></i></a>
						<ul class="dropdown-menu pull-right">
							<li><a href="javascript:doHelpSparqlGraph();">Docs for SparqlGraph</a></li>
							<li><a href="javascript:doHelp();">Docs for this Tab</a></li>
							<li><a href="javascript:doHelpBlog();">Blog Bug or Feature</a></li>
							<li><a href="javascript:doTest();">Test</a></li>
							<li><a href="javascript:doAbout();">About</a></li>
						</ul>
					</li> 
				</ul> 
				
				<span class="right">
				  				   
					<div class="btn-group">
						<button id="query-tab-but"  class="btn" onclick="anchorTab1.click();" disabled><i class="icon-sitemap"></i> Query</button>
						<button id="mapping-tab-but" class="btn" onclick="anchorTab2.click();" disabled><i class="icon-table"></i> Map Input</button>  
						<button id="upload-tab-but" class="btn" onclick="anchorTab3.click();" disabled><i class="icon-cloud-upload"></i> Import</button>      
					</div>  
				
				</span>
			</div>
		</div>
	</div>
	
	 
	
	<script src="../../iidx-oss/components/respond/respond.src.js"></script>
	
    <div id="status" class="container"></div>
	<div id="tabs">
		<ul hidden>
			    <li><a id='anchorTab1' href="#tabs-1">SparqlGraph</a></li>
			    <li><a id='anchorTab2' href="#tabs-2">Map Input</a></li>
			    <li><a id='anchorTab3' href="#tabs-3">Import</a></li>
			    
		</ul>
		  <div id="tabs-1">
			 <!--  ------------   PAGE ----------------  -->
		
		    <div class="container">
		    	<br>
		    	<!------------  button toolbar ------------>
		   	    <form class="form-search" action="javascript:doSearch()">
		   	    	
		   			<div class="input-append">
		   				<input type="text" id="search" class="input-medium search-query" align="left">
		   				<button type="submit" class="btn btn-icon"><i class="icon-search"></i></button>
		   			</div>
		 			<br>
		 			<table width="100%"><tr>  
		 				<td align="left">  
		   	    			<button class="btn btn-disabled" id="btnTreeExpand"   onclick="javascript:doExpand(); return false;"  disabled>Expand</button>
						    <button class="btn btn-disabled" id="btnTreeCollapse" onclick="javascript:doCollapse(); return false;" disabled>Collapse</button>
						</td>
						<td align="right">
							<button class="btn" id="btnLayout"   onclick="javascript:doLayout(); return false;" disabled><i class="icon-magnet"></i></button>
							<button class="btn btn-disabled" id="btnGraphClear"   onclick="javascript:clearGraph(); return false;" disabled>Clear</button>
						    <button class="btn btn-disabled" id="btnGraphExecute" onclick="javascript:graphExecute(); return false;" disabled>Execute</button>
						</td>
					</tr></table>
		   		</form>
				
				<!------------  Tree and canvas ------------>
				<style> 
					div.outsidewrap {
						padding:3px; 
						background-color:white; 
						resize:vertical; 
						height:500px; 
						overflow:auto
					}
					div.treewrap {
						border: 1px solid gray;
						height:100%;
						width:22%;
						resize:horizontal;
						overflow:auto;
						background-color:white;
						float:left;
					}
					div.canvaswrap {
						border: 1px solid gray;
						background-color:white; 
						height:100%; width:auto; 
						overflow:auto;
					}
					div.importcanvas {
						height:100%;
						width:75%;
						resize:horizontal;
						background-color:white;
						float:left;
					}
					div.importcols {
						height:100%;
						overflow: hidden;           
						background-height:700px; 
					}
				</style>
					
				<div id="treeCanvasWrapper" class="outsidewrap" style="overflow:hidden">
					<div id="treeWrapper"  class="treewrap ui-corner-all ui-widget-content">
						<div id="treeDiv" ></div>
				    </div>
					<div id="canvasWrapper" class="canvaswrap">
						<div id="canvas" style="" class="canvas ui-widget-content">
						</div>
					</div>	
				</div>
					
				<br>
				
				<!------------  Query Section ------------>
				
				<section class="module collapsible in">
					<header class="module-header">Query:</header>
					<div class="module-body collapse">
				  		<div id="querydiv"  class="control-group" style="width:100%">
				  			<table width="100%"><tbody><tr>
				  				<td>
							   		<form class="form-horizontal">
								   		<button class='btn disabled' id="btnQueryBuild" onclick="javascript:buildQuery(); return false;" disabled>build</button>
								   		<button class='btn disabled' id="btnQueryRun"   onclick="javascript:runQuery(); return false;"   disabled>run</button>
							   		</form>
							   	</td>
							   	<td align="right">
							   		<form class="form-horizontal">
							 			&nbsp; query: 
							 			<select class="input-medium" id="SGQueryType">
							 				<option value="SELECT">select distinct</option>
							 				<option value="COUNT">count</option>
							 				<option value="CONSTRUCT">construct</option>
							 				<option value="DELETE">delete</option>
							 			</select>
							   			&nbsp; source: 
							   			<select class="input-medium" id="SGQuerySource">
							   				<option value="QUERY_SERVICE">query service</option>
							   				<option value="DIRECT">direct</option>
							   		<!--  	<option value="DISPATCHER">dispatcher</option> -->
							   			</select>
							   			&nbsp; limit: <input type="text" class="input-mini" id="SGQueryLimit" value="1000" onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
							   			&nbsp; <input type="checkbox" class='checkbox' id="SGQueryNamespace" checked> Show namespaces </input>
						   			</form>
							   	</td>
					   		</tr></tbody></table>
							   	    			
					   		<textarea NAME="Query" id="queryText" ROWS=15 COLS=100 autocomplete="off" class="input-xlarge"  style="width:100%">
					   		</textarea>
				  		</div>
				  	</div>
		  		</section>
		  		
		  		<br>
		  		
		  		<!------------  Results Section ------------>
				<section id="resultsSection" class="module collapsible in">
					<header class="module-header">Results</header>
					<!--  div class="btn-group" align="right" style="width:100%">
		               <button class="btn dropdown-toggle disabled" data-toggle="dropdown" id="btnDownloadCSV"><i class="icon-chevron-down" disabled></i></button>
		               <ul class="dropdown-menu pull-right">
		                 <li><a href="javascript:doDownloadCSV();">Save as CSV</a></li>
		               </ul>
		            </div -->
					<div id="resultsDiv" class="module-body collapse in" style="width:100%">
						<p id="resultsParagraph"><table id='resultsTable'></table>
					</div>
				</section>
				<br>
					   		
			</div>
		</div>
		
		<!------  Data Import Tab ------>
		<div id="tabs-2" >
			<div class="container">
				<div id="importdiv">
					<br>
					<section class="module collapsible">
				    	<header class="module-header">Options</header>
						<div id="importoptionsdiv" class="module-body collapse">
						</div>
				    </section>
					<br>
				    <section class="module">
				      <div id="mappingtabdiv" class="module-body">
					    	<div id="importcanvasdiv" class="importcanvas">
					    	</div>
					    	<div id="importcolsdiv" class="importcols">
					    	</div>
				      </div>
				    </section>
				</div>
			</div>
		</div>
		
		<!------  Data Upload Tab ------>
		<div id="tabs-3">
			<div class="container">
				<div id="uploaddiv">
					<br>
					<section class="module collapsible">
				    	<header class="module-header">Graph Tools</header>
						<div id="uploadtoolsdiv" class="module-body collapse">
						</div>
				    </section>
					<br>
				    <section class="module">
						<div id="uploadtabdiv" class="module-body">
						</div>
				    </section>
				</div>
			</div>
		</div>
	</div>
	
	<script type="text/javascript">
	// Things that need to be done after HTML is all loaded
	
	// Paul's html5 voodoo:  to allow json files to be dropped
	var dropbox = document.getElementById("treeCanvasWrapper")
	dropbox.addEventListener("dragenter", noOpHandler, false);
	dropbox.addEventListener("dragexit",  noOpHandler, false);
	dropbox.addEventListener("dragover",  noOpHandler, false);
	dropbox.addEventListener("drop",      fileDrop, false);
	// End html5 voodoo
	
    require(['modules'], function() {
    $('.module.collapsible').collapsible();
    });
    </script>
	
    <script type="text/javascript">
    require([
    'jquery',
    'modules'
    ], function($) {
    $('.module.collapsible').collapsible();
    });
    
    $('body').find('i[rel=tooltip]').tooltip();
    </script>

  <div><footer class="module-footer"><small><center>
		<a href="https://github.com/ge-semtk/semtk" target="_blank">Github</a> 
		&nbsp;&nbsp;|&nbsp;&nbsp;
		<a href="https://github.com/ge-semtk/semtk/issues" target="_blank">Issues</a>
		&nbsp;&nbsp;|&nbsp;&nbsp;
		<a href="#" onclick="doAbout(); return false;">Legal</a></p>
  </center></small></footer></div>
<!------------  Invisible stuff ------------>
<div id="modaldialog"></div>  
<input type="file" id="fileInput" style="display:none">

</body>
</html>
